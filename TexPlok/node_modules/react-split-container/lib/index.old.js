'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var _react=require('react'),_react2=_interopRequireDefault(_react),_reactDom=require('react-dom'),_reactClass=require('react-class'),_reactClass2=_interopRequireDefault(_reactClass),_objectAssign=require('object-assign'),_objectAssign2=_interopRequireDefault(_objectAssign),_reactStyleNormalizer=require('react-style-normalizer'),_reactStyleNormalizer2=_interopRequireDefault(_reactStyleNormalizer),_Splitter=require('./Splitter'),_Splitter2=_interopRequireDefault(_Splitter),_styles=require('./styles'),_styles2=_interopRequireDefault(_styles),_join=require('./join'),_join2=_interopRequireDefault(_join),_bemFactory=require('./bemFactory'),_bemFactory2=_interopRequireDefault(_bemFactory),_isNumber=require('./isNumber'),_isNumber2=_interopRequireDefault(_isNumber),_calc=require('./calc'),_calc2=_interopRequireDefault(_calc);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return call&&('object'==typeof call||'function'==typeof call)?call:self}function _inherits(subClass,superClass){if('function'!=typeof superClass&&null!==superClass)throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var PERCENTAGE_RE=/%/;var CLASS_NAME='react-split-container',bem=(0,_bemFactory2.default)(CLASS_NAME),m=function m(a){return bem(null,a)},isPercentage=function isPercentage(a){return!(0,_isNumber2.default)(a)&&'string'==typeof a&&(0,_isNumber2.default)(a.replace(PERCENTAGE_RE,''))},getSizeName=function getSizeName(a){var b='horizontal'==a.orientation;return b?'height':'width'},getPositionNames=function getPositionNames(a){var b='horizontal'==a.orientation;return b?['top','bottom']:['left','right']},getClientSizeName=function getClientSizeName(a){var b=getSizeName(a);return'client'+b[0].toUpperCase()+b.substring(1)},getFixedIndex=function getFixedIndex(a){return'string'==typeof a.fixedIndex&&(a.fixedIndex*=1),0===a.fixedIndex?0:1===a.fixedIndex?1:-1},emptyFn=function emptyFn(){};var SplitContainer=function(_Component){function SplitContainer(a){_classCallCheck(this,SplitContainer);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(SplitContainer).call(this,a));return _this.state={dragging:!1},_this.state={dragging:!1},_this}return _inherits(SplitContainer,_Component),_createClass(SplitContainer,[{key:'isMounted',value:function isMounted(){return!!(0,_reactDom.findDOMNode)(this)}},{key:'prepareStyle',value:function prepareStyle(a,b){var c='horizontal'==a.orientation,d=c?a.defaultHorizontalStyle:a.defaultVerticalStyle,e=(0,_objectAssign2.default)({},a.defaultStyle,a.style);return b.dragging&&(0,_objectAssign2.default)(e,{cursor:c?'ns-resize':'ew-resize'}),(0,_objectAssign2.default)(e,d)}},{key:'adjustMinSizes',value:function adjustMinSizes(a,b,c,d){var e='horizontal'==b.orientation,f=e?'minHeight':'minWidth',g=e?'maxHeight':'maxWidth',h=0,i=this.getCollapsedInfo(b,c);b.firstMinSize&&(h+=b.firstMinSize,d.first[f]=b.firstMinSize,d.second[g]=(0,_calc2.default)('100%',-b.firstMinSize,-a)),b.secondMinSize&&(h+=b.secondMinSize,d.second[f]=b.secondMinSize,d.first[g]=(0,_calc2.default)('100%',-b.secondMinSize,-a)),i.first&&delete d.second[g],i.second&&delete d.first[g],h&&(b.style[f]=h)}},{key:'prepareSplitterStyle',value:function prepareSplitterStyle(a,b){var c='horizontal'==a.orientation,d=getSizeName(a),e=c?a.defaultHorizontalSplitterStyle:a.defaultVerticalSplitterStyle,f=(0,_objectAssign2.default)({},a.defaultSplitterStyle,e,a.splitterStyle);a.splitterSize&&(f[d]=a.splitterSize),'undefined'==typeof f[d]&&(f[d]=a.defaultSplitterSize),b.dragging;var g=this.getCollapsedInfo(a,b);return(g.first||g.second||a.locked)&&(f.cursor='auto'),(0,_reactStyleNormalizer2.default)(f)}},{key:'getCollapsedInfo',value:function getCollapsedInfo(a,b){var c='undefined'==typeof b.firstCollapsed?a.firstCollapsed:b.firstCollapsed,d='undefined'==typeof b.secondCollapsed?a.secondCollapsed:b.secondCollapsed;return{first:c,second:d}}},{key:'prepareChildrenStyles',value:function prepareChildrenStyles(a,b,c){var i,j,d=getSizeName(a),e=_styles2.default.prepare(a),f=c/2,g=b.dragOffset||0,h=a.splitAt,k=this.getCollapsedInfo(a,b);return k.first||k.second?k.first?(j=(0,_calc2.default)('100%',-c),e.first.display='none'):(i=(0,_calc2.default)('100%',-c),e.second.display='none'):(0,_isNumber2.default)(h)?(i=(0,_calc2.default)(h,g),j=(0,_calc2.default)('100%',-h,-c,-g)):(i=(0,_calc2.default)(h,-f,g),j=(0,_calc2.default)('100%','-',h,-f,-g)),e.first[d]=i,e.second[d]=j,e}},{key:'prepareProps',value:function prepareProps(a){var b=this.p=(0,_objectAssign2.default)({},a);return b.horizontal='horizontal'==b.orientation,b.className=this.prepareClassName(b),b}},{key:'prepareClassName',value:function prepareClassName(a){return(0,_join2.default)(CLASS_NAME,m(a.orientation),a.theme&&m('theme-'+a.theme))}},{key:'render',value:function render(){var a=this.p=this.prepareProps(this.props),b=a.horizontal,c=b?'height':'width';this.asPercentage=isPercentage(a.splitAt),a.children=a.children||[];var d='undefined'!=typeof this.state.splitAt;d&&(a.splitAt=this.state.splitAt),a.splitterStyle=this.prepareSplitterStyle(a,this.state),a.style=this.prepareStyle(a,this.state);var e=a.splitterSize=parseFloat(a.splitterStyle[c]);this._adjusting&&this.adjustBefore(a,this.state,e);var f=this.prepareChildrenStyles(a,this.state,e);this._adjusting&&this.adjustAfter(a,this.state,f),this.adjustMinSizes(e,a,this.state,f),this.shouldAdjust(a)&&(this._adjusting?this._adjusting=!1:setTimeout(function(){this._adjusting=!0,this.isMounted()&&this.setState({},function(){this._adjusting=!1}.bind(this))}.bind(this),0));var g=this.getCollapsedInfo(a,this.state);return this.state.props=a,_react2.default.createElement('div',a,_react2.default.createElement('div',{className:(0,_join2.default)('item first',CLASS_NAME+'__first',CLASS_NAME+'__first--orientation-'+a.orientation),style:f.first},a.children[0]),_react2.default.createElement(_Splitter2.default,{beforeMin:a.firstMinSize,afterMin:a.secondMinSize,size:e,arrowSize:a.arrowSize,arrowColor:a.arrowColor,arrowPadding:a.arrowPadding,style:a.splitterStyle,onDragStart:this.handleSplitterDragStart,onDrag:this.handleSplitterDrag,onDrop:this.handleSplitterDrop,onCollapse:this.handleCollapse,onExpand:this.handleExpand,orientation:a.orientation,locked:a.locked,firstCollapsed:g.first,secondCollapsed:g.second,firstCollapsible:a.firstCollapsible,secondCollapsible:a.secondCollapsible,onMouseDown:this.handleSplitterMouseDown}),_react2.default.createElement('div',{className:(0,_join2.default)('item first',CLASS_NAME+'__second',CLASS_NAME+'__second--orientation-'+a.orientation),style:f.second},a.children[1]))}},{key:'getSplitterSize',value:function getSplitterSize(a){a=a||this.props;var b=a.splitterStyle;return b[getSizeName(a)]||10}},{key:'getTotalSize',value:function getTotalSize(a){a=a||this.props;var b=(0,_reactDom.findDOMNode)(this);return b[getClientSizeName(a)]}},{key:'adjustBefore',value:function adjustBefore(a,b,c){var e,f,d=getFixedIndex(a);return~d?void(0===d&&!(0,_isNumber2.default)(a.splitAt)&&(e=this.getTotalSize(a),f=parseFloat(a.splitAt),a.splitAt=f*e/100-c/2)):void(isPercentage(a.splitAt)||(a.splitAt=this.getPercentageFor(parseFloat(a.splitAt)+c/2)+'%'))}},{key:'getPercentageFor',value:function getPercentageFor(a,b){var c=this.getTotalSize(b);return 100*a/c}},{key:'adjustAfter',value:function adjustAfter(a,b,c){var d=this.getCollapsedInfo(a,b);if(!(d.first||d.second)&&1===getFixedIndex(a)){var e=getSizeName(a),f=getClientSizeName(a),g=(0,_reactDom.findDOMNode)(this).children[2],h=g[f];c.second[e]=h,c.first[e]=(0,_calc2.default)('100%',-a.splitterStyle[e],-h)}}},{key:'shouldAdjust',value:function shouldAdjust(a){if(this.state.dragging)return!1;var b=getFixedIndex(a);//fixed index is 1
//so we always have to adjust
return~b?0!==b||!(0,_isNumber2.default)(a.splitAt):!isPercentage(a.splitAt)}},{key:'handleSplitterMouseDown',value:function handleSplitterMouseDown(a){this.props.onSplitterMouseDown(a)}},{key:'handleSplitterDragStart',value:function handleSplitterDragStart(a,b){this.props[this.props.onDragStartName](a,b)}},{key:'getCurrentSplitAt',value:function getCurrentSplitAt(){var a=getClientSizeName(this.state.props),b=(0,_reactDom.findDOMNode)(this).children[0],c=b[a];return c}},{key:'handleSplitterDrag',value:function handleSplitterDrag(a,b){var c=getPositionNames(this.props),d=c[0],e=a[d];this.props[this.props.onDragName](a,b),e=a[d];var f={};return f[c[0]]=e,this.setState({dragging:!0,dragOffset:e,dragSplitterStyle:f}),e}},{key:'handleSplitterDrop',value:function handleSplitterDrop(a,b){var c=getPositionNames(this.props),d=c[0],e=a[d],f={dragging:!1,dragOffset:0,dragSplitterStyle:null};if(e){var g=this.state.props,h=this.getCurrentSplitAt(),i={splitAt:h,orientation:this.props.orientation,fixedIndex:this.props.fixedIndex};this.adjustBefore(i,this.state,g.splitterSize);var j=i.splitAt;this.props.stateful&&(f.splitAt=j)}this.setState(f),e&&(this.asPercentage!=isPercentage(j)&&(this.asPercentage&&!isPercentage(j)&&(j=this.getPercentageFor(j+g.splitterSize/2)),!this.asPercentage&&isPercentage(j)&&(j=h),this.asPercentage&&!isPercentage(j)&&(j+='%')),this.props[this.props.onDropName](j,b))}},{key:'handleCollapse',value:function handleCollapse(a){var b={};-1==a?b.firstCollapsed=!0:b.secondCollapsed=!0,this.props.stateful&&this.setState(b),this.props[this.props.onCollapseName](b.firstCollapsed?0:1)}},{key:'handleExpand',value:function handleExpand(a){var b={};-1==a?b.firstCollapsed=!1:b.secondCollapsed=!1,this.props.stateful&&this.setState(b),this.props[this.props.onExpandName](!1===b.firstCollapsed?0:1)}}]),SplitContainer}(_reactClass2.default);exports.default=SplitContainer;SplitContainer.propTypes={children:function children(a,b){var c=_react2.default.Children.toArray(a[b]),d=Array.isArray(c),e=d&&2==c.length;c&&d&&e||console.warn('Please pass only 2 children. You provided '+(d?c.length+' children':c))},orientation:_react.PropTypes.oneOf(['horizontal','vertical']),splitterSize:_react.PropTypes.number,locked:_react.PropTypes.bool,stateful:_react.PropTypes.bool},SplitContainer.defaultProps=(0,_objectAssign2.default)({theme:'default',orientation:'horizontal',defaultStyle:{},defaultHorizontalStyle:{},defaultVerticalStyle:{},defaultSplitterStyle:{},defaultHorizontalSplitterStyle:{},defaultVerticalSplitterStyle:{},// defaultSplitterSize: 12,
arrowSize:6,arrowColor:'rgb(118, 118, 118)',arrowPadding:10,splitAt:'50%',fixedIndex:null,locked:!1,stateful:!1,onDrop:emptyFn,onDragStart:emptyFn,onDrag:emptyFn,onSplitterMouseDown:emptyFn,onExpand:emptyFn,onCollapse:emptyFn,onDragStartName:'onDragStart',onDragName:'onDrag',onDropName:'onDrop',onExpandName:'onExpand',onCollapseName:'onCollapse'},_styles2.default.defaults);